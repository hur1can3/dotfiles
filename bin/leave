#!/bin/bash
#
# a simple logout dialog
#
# requires:
#   zenity
#   wmctrl
#
###

# exit if we're not in X
[ -z "$DISPLAY" ] && exit 1

# create the dialog
choice=$(zenity --title="Logout $HOSTNAME" \
                --text="Logout $HOSTNAME:" \
                --list --radiolist \
                --hide-column=3 --print-column=3 \
                --column="" --column="" --column="" \
                TRUE Logout 0 FALSE Reboot 1 FALSE Shutdown 2)

# exit here if no choice was made
[ -z "$choice" ] && exit 1

# gracefully close all open apps
for app in $(wmctrl -l | awk '{print $1}'); do 
  wmctrl -i -c $app
done

# execute the choice in background
case $choice in
  0) kill $(pgrep X) &      ;;
  1) sudo shutdown -r now & ;;
  2) sudo shutdown -h now & ;;
esac

# exit the script
exit 0
